\documentclass[a4paper, 12pt]{article}
\usepackage[T2A]{fontenc}
\usepackage[utf8]{inputenc} 
\usepackage[russian,english]{babel}
\usepackage[pdftex,unicode]{hyperref}
\usepackage{cmap}

\begin{document}

\begin{itemize}
\item$s$ --- входная строка.
\item$t$ --- период строки $s$.
\itemИндексация начинается с 0.
\end{itemize}
Чтобы найти максимальное $k$, нужно найти минимальный период $t$
строки $s$. Построим $Z$-функцию по строке $s$. Рассмотрим значение $Z$-функции в $i$-м элементе, причем $i$ > 0.
\\Если \[ i = min{\{ Z_s[i] =  |s| - i \}}, \] то мы сдвинулись от 0 элемента ровно
на минимальный период строки, то есть на $|t|$ (по определению
$Z$-функции). Очевидно$^*$, что это самый маленький период, т.к. мы
выбираем самый маленький $t$, удовлетворяющий условию, а если условие
не выполнено, то $t$ не является периодом строки.
\\Таким образом, \[ |t| = i. \]
Чтобы найти $k$, осталось только разделить $|s|$ на $|t|$.
$$\left\{
\begin{array}{rcl}
Z_s[i] & = & |s| - i\\
k & = & |s|~/~i.\\
\end{array}
\right.$$
\\Осталось только проверить, является ли строка
периодичной. Т.е. разделить длину строки на длину периода и убедиться,
что остаток от деления равен 0: \[ |s|~\%~|t|~=~0. \]
\\Так как $Z$-функцию можно найти за линейное время(доказано на
лекции), то для решения этой задачи также потребуется линейное
время. Точнее --- $O(t)$, так как достаточно построить $Z$-функцию
только для первых $t$ символов строки $s$.\\Памяти потребуется $O(|s|
+ |t|)$~=~$O(|s|)$ --- линейная сложность.
\newline
\newline
$^*$ Рассмотрим строку $s$. Любую строку можно представить в виде
$\alpha^n$, т.е. $|s|$~=~$\alpha\alpha...\alpha$. Пусть
$|\alpha|$~=~$l$. Будем идти по строке $s$, начиная с первого символа и
будем прикладывать суффикс строки $s$: $s$[$i$: ](где $i$ --
текущий символ) к началу строки $s$. Сравниваем посимвольно. Как
только символы не совпали, останавливаемся, записываем число совпавших
символов.\\Пусть теперь мы сдвинулись на $i$ = $l$, тогда мы получим
количество совпавших символов равное длине суффикса $s$[$i$: ] =
$s$[$l$: ](потому что $\alpha$ равна сама себе посимвольно), а именно:
$|s|$ - $l$(больше получить нельзя принципиально).
\\Предположим, что $\alpha$ -- минимальный период $s$. И пусть мы
сдвинулись на $i$ < $l$, тогда если значение $Z$-функции в этой точке
больше либо равно $l$, то значит некоторый суффикс $\alpha$ совпадает с
соответствующим ему префиксом $\alpha$, но это означает, что $\alpha$
можно разбить на периоды, что противоречит условию. А если $|Z|$ <
$l$, тогда $s$[0:$i$] -- не является периодом.

\end{document}
